<button id="start-button">Start</button>
<canvas id="canvas" width="400" height="400"></canvas>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  const blockSize = 40;
  const numRows = 10;
  const numCols = 10;

const colors = ['red', 'yellow', 'blue', 'orange', 'green', 'purple'];

// Generate a random color for the blocks
function getRandomColor() {
  let index = Math.floor(Math.random() * colors.length);
  return colors[index];
}

  // Create a 2D array to represent the grid of blocks
  let grid = [];
  for (let row = 0; row < numRows; row++) {
    grid[row] = [];
    for (let col = 0; col < numCols; col++) {
      grid[row][col] = {
        x: col * blockSize,
        y: row * blockSize,
        color: getRandomColor(),
        selected: false
      };
    }
  }

   // Track the selected block
  let selectedBlock = null;

// Draw the blocks on the canvas
  function draw() {
    for (let row = 0; row < numRows; row++) {
      for (let col = 0; col < numCols; col++) {
        let block = grid[row][col];
        ctx.fillStyle = block.color;
        ctx.fillRect(block.x, block.y, blockSize, blockSize);

        if (block.selected) {
          ctx.strokeStyle = 'white';
          ctx.lineWidth = 3;
          ctx.strokeRect(block.x, block.y, blockSize, blockSize);
        }
      }
    }
  }

// Check for matching blocks and remove them from the grid
function checkForMatches() {
  for (let row = 0; row < numRows; row++) {
    for (let col = 0; col < numCols; col++) {
      let block = grid[row][col];
      if (block == null) continue; // skip null blocks

      let color = block.color;

      // Check for horizontal matches
      if (col < numCols - 2 &&
          grid[row][col + 1] != null &&
          grid[row][col + 2] != null &&
          grid[row][col + 1].color == color &&
          grid[row][col + 2].color == color) {
        grid[row][col] = null;
        grid[row][col + 1] = null;
        grid[row][col + 2] = null;
      }

      // Check for vertical matches
      if (row < numRows - 2 &&
          grid[row + 1][col] != null &&
          grid[row + 2][col] != null &&
          grid[row + 1][col].color == color &&
          grid[row + 2][col].color == color) {
        grid[row][col] = null;
        grid[row + 1][col] = null;
        grid[row + 2][col] = null;
      }
    }
  }

  // Update the rows and columns of the remaining blocks
  for (let row = 0; row < numRows; row++) {
    for (let col = 0; col < numCols; col++) {
      let block = grid[row][col];
      if (block == null) continue; // skip null blocks
      block.row = row;
      block.col = col;
    }
  }
}

  // Move the blocks down and refill the grid from the top
  function update() {
    for (let row = numRows - 1; row >= 0; row--) {
      for (let col = 0; col < numCols; col++) {
        if (grid[row][col] == null) {
          // Shift blocks down
          for (let r = row; r > 0; r--) {
            grid[r][col] = grid[r - 1][col];
          }
          grid[0][col] = {
            x: col * blockSize,
            y: 0,
            color: getRandomColor(),
            selected: false
          };
        }
      }
    }
  }

  // Handle mouse clicks on the canvas
  canvas.addEventListener('click', function(event) {
    let x = event.offsetX;
    let y = event.offsetY;
    let col = Math.floor(x / blockSize);
    let row = Math.floor(y / blockSize);
    let block = grid[row][col];

    if (block === selectedBlock) {
      // Unselect the block if it was already selected
      block.selected = false;
      selectedBlock = null;
    } else if (selectedBlock == null) {
      // Select the block if no block was previously selected
      block.selected = true;
      selectedBlock = block;
    } else {
      // Swap the selected block with the clicked block if they are adjacent
      if (Math.abs(selectedBlock.col - col) + Math.abs(selectedBlock.row - row) == 1) {
        let temp = grid[selectedBlock.row][selectedBlock.col];
        grid[selectedBlock.row][selectedBlock.col] = block;
        grid[row][col] = temp;
        block.selected = false;
        selectedBlock = null;
      } else {
        // Unselect the current block if it is not adjacent
        selectedBlock.selected = false;
        selectedBlock = null;
      }
    }
  });

  // Main game loop
  function loop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    draw();
    checkForMatches();
    update();
    requestAnimationFrame(loop);
  }

   const startButton = document.getElementById('start-button');

  // Start the game when the start button is clicked
  startButton.addEventListener('click', function() {
    loop();
  });
</script>

